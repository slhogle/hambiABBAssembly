{
  "hash": "3f6d206555d32c4b4feb45887e069b06",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Designing four-species subcommunities\"\nauthor: \"Shane Hogle\"\ndate: today\nlink-citations: true\n---\n\n\n# Setup\n\n## Libraries\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(tidyverse)\nlibrary(ggplate)\n```\n:::\n\n\n## Functions and vars\n\nSpecies color vector\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_colors <- c(\n  \"ANC_0403_10\" = \"#ffaaaa\", \"ANC_0403_70\" = \"#aa0000\", \"ANC_0403_80\" = \"#aa0000\", \"ANC_0403_90\" = \"#aa0000\", \n  \"ANC_1287_10\" = \"#ffeeaa\", \"ANC_1287_70\" = \"#d4aa00\", \"ANC_1287_80\" = \"#d4aa00\", \"ANC_1287_90\" = \"#d4aa00\", \n  \"ANC_1896_10\" = \"#ccffaa\", \"ANC_1896_70\" = \"#44aa00\", \"ANC_1896_80\" = \"#44aa00\", \"ANC_1896_90\" = \"#44aa00\", \n  \"ANC_1977_10\" = \"#aaccff\", \"ANC_1977_70\" = \"#0055d4\", \"ANC_1977_80\" = \"#0055d4\", \"ANC_1977_90\" = \"#0055d4\",\n  \"EVO_0403_10\" = \"#ffaaee\", \"EVO_0403_70\" = \"#ff00cc\", \"EVO_0403_80\" = \"#ff00cc\", \"EVO_0403_90\" = \"#ff00cc\", \n  \"EVO_1287_10\" = \"#ffccaa\", \"EVO_1287_70\" = \"#ff6600\", \"EVO_1287_80\" = \"#ff6600\", \"EVO_1287_90\" = \"#ff6600\", \n  \"EVO_1896_10\" = \"#aaffee\", \"EVO_1896_70\" = \"#00ffcc\", \"EVO_1896_80\" = \"#00ffcc\", \"EVO_1896_90\" = \"#00ffcc\", \n  \"EVO_1977_10\" = \"#ccaaff\", \"EVO_1977_70\" = \"#7f2aff\", \"EVO_1977_80\" = \"#7f2aff\", \"EVO_1977_90\" = \"#7f2aff\"\n  )\n```\n:::\n\n\nFor plotting plates\n\n::: {.cell}\n\n```{.r .cell-code}\nplate_plot_steps <- function(df, well_colmun, val_column, step, colr_vec){\n  ggplate::plate_plot(df,\n  position = {{ well_colmun }},\n  value = {{ val_column }},\n  colour = colr_vec,\n  plate_size = 96,\n  plate_type = \"round\"\n) + ggtitle(step)\n}\n```\n:::\n\n\n# Construct quartet combinations\n\nGet all possible quartets while excluding combinations of ANC/EVO of the same species\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombos04 <- t(combn(c(\"ANC_0403\", \"EVO_0403\", \"ANC_1287\", \"EVO_1287\", \"ANC_1896\", \"EVO_1896\", \"ANC_1977\", \"EVO_1977\"),  4))\ncombos04 <- tibble(\"a\" = combos04[, 1], \"b\" = combos04[, 2], \"c\" = combos04[, 3], \"d\" = combos04[, 4])\ncombos04_filt <- combos04 %>%\n  filter(str_extract(a, \"\\\\d+\") != str_extract(b, \"\\\\d+\")) %>% \n  filter(str_extract(a, \"\\\\d+\") != str_extract(c, \"\\\\d+\")) %>% \n  filter(str_extract(a, \"\\\\d+\") != str_extract(d, \"\\\\d+\")) %>% \n  filter(str_extract(b, \"\\\\d+\") != str_extract(c, \"\\\\d+\")) %>%\n  filter(str_extract(b, \"\\\\d+\") != str_extract(d, \"\\\\d+\")) %>% \n  filter(str_extract(c, \"\\\\d+\") != str_extract(d, \"\\\\d+\"))\n```\n:::\n\n\nMake plate layouts for the 4-species combos\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombos04_filt_wells <- combos04_filt %>% \n  slice(rep(1:n(), each = 4)) %>%\n  mutate(a = paste(a, c(70, 10, 10, 10), sep = \"_\"),\n         b = paste(b, c(10, 70, 10, 10), sep = \"_\"),\n         c = paste(c, c(10, 10, 70, 10), sep = \"_\"),\n         d = paste(d, c(10, 10, 10, 70), sep = \"_\")) %>% \n  add_count(a, name = \"a_count\") %>% \n  add_count(b, name = \"b_count\") %>% \n  add_count(c, name = \"c_count\") %>% \n  add_count(d, name = \"d_count\") %>% \n  arrange(desc(a_count), a, desc(b_count), b, desc(c_count), c, desc(d_count), d) %>%\n  mutate(row = c(rep(LETTERS[c(5, 3, 6, 4)], each = 12), rep(LETTERS[1:2], each = 8))) %>% \n  group_by(row) %>% \n  mutate(col = if_else(!(row %in% c(\"A\", \"B\")), str_pad(1:length(row), 2, pad = \"0\"), str_pad(1:length(row)+4, 2, pad = \"0\"))) %>% \n  ungroup() %>%\n  mutate(well = paste0(row, col))\n```\n:::\n\n\n## First pipetting step\n\n::: {#fig-01}\n\n::: {.cell}\n::: {.cell-output-display}\n![](03_quartets_files/figure-html/unnamed-chunk-6-1.png){width=768}\n:::\n:::\n\nLayout for the first pipetting step for constructing quartets Different colors show different species/evolution combinations. The darkness of the color indicates whether a species/evolution combo is added at 70% (e.g., `_70`) or 10% (e.g., `_10`).\n:::\n\n## Second pipetting step\n\n::: {#fig-02}\n\n::: {.cell}\n::: {.cell-output-display}\n![](03_quartets_files/figure-html/unnamed-chunk-7-1.png){width=768}\n:::\n:::\n\nLayout for the second pipetting step for constructing quartets Different colors show different species/evolution combinations. The darkness of the color indicates whether a species/evolution combo is added at 70% (e.g., `_70`) or 10% (e.g., `_10`).\n:::\n\n## Third pipetting step\n\n::: {#fig-03}\n\n::: {.cell}\n::: {.cell-output-display}\n![](03_quartets_files/figure-html/unnamed-chunk-8-1.png){width=768}\n:::\n:::\n\nLayout for the third pipetting step for constructing quartets Different colors show different species/evolution combinations. The darkness of the color indicates whether a species/evolution combo is added at 70% (e.g., `_70`) or 10% (e.g., `_10`).\n:::\n\n## Fourth pipetting step\n\n::: {#fig-04}\n\n::: {.cell}\n::: {.cell-output-display}\n![](03_quartets_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\nLayout for the fourth pipetting step for constructing quartets Different colors show different species/evolution combinations. The darkness of the color indicates whether a species/evolution combo is added at 70% (e.g., `_70`) or 10% (e.g., `_10`).\n:::",
    "supporting": [
      "03_quartets_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}